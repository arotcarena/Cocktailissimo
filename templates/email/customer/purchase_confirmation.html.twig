{% extends "email/base.html.twig" %}

{% block title %}{{ 'purchase_confirmation.title' | trans({}, 'emails', purchase.lang) }}{% endblock %}

{% block body %}
    <h1 style="font-size: 1.4em;">{{ 'purchase_confirmation.h1' | trans({}, 'emails', purchase.lang) }}</h1>

    {% set amount = (purchase.totalPrice + purchase.shippingInfo.price) | price_format(purchase.lang) %}
    <p style="margin: 40px 0; line-height: 1.4;">{{'purchase_confirmation.message' | trans({amount: amount, ref: purchase.ref}, 'emails', purchase.lang)}}</p>

    <div style="margin: 20px 0;">
        <h3>{{ 'contact_phone_number' | trans({}, 'emails', purchase.lang) }}</h3>
        <p>{{ purchase.phone }}</p>
    </div>
    
    <div style="padding: 15px; background-color: rgb(250, 250, 250); ; max-width: 500px;">
        <h2 style="font-size: 1.4em; margin-top: 0;">{{ 'orderSummary' | trans({}, 'messages', purchase.lang) }}</h2>
        <div>
            <h3>{{ 'orderSummary.detail' | trans({}, 'messages', purchase.lang) }}</h3>
            {% for purchaseLine in purchase.purchaseLines %}
                <div>{{ purchaseLine.quantity }} x {{ attribute(purchaseLine.product.designation, purchase.lang ) }} = {{ purchaseLine.totalPrice | price_format(purchase.lang) }}</div>
            {% endfor %}
            <br>
            <div>{{ 'orderSummary.detail.articleTotalPrice' | trans({}, 'messages', purchase.lang) }} : {{ purchase.totalPrice | price_format(purchase.lang) }}</div>
            <div>{{ 'orderSummary.detail.shippingCost' | trans({}, 'messages', purchase.lang) }} : {{ purchase.shippingInfo.price | price_format(purchase.lang) }}</div>
            <div>{{ 'orderSummary.detail.total' | trans({}, 'messages', purchase.lang) }} : {{ (purchase.shippingInfo.price + purchase.totalPrice) | price_format(purchase.lang)}}</div>
        </div>
        <div>
            <h3>{{ 'deliveryMethod' | trans({}, 'messages', purchase.lang) }}</h3>
            <p>{{ attribute(purchase.shippingInfo.name, purchase.lang) }}</p>
        </div>
        <div>
            {% if isAtHomeDelivery %}
                <h3>{{ 'deliveryAddress' | trans({}, 'messages', purchase.lang) }}</h3>
                {% set address = purchase.deliveryDetail %}
                <p>
                    <span style="text-transform: capitalize;">{{ address.civility | trans({}, 'configs', purchase.lang) }} {{ address.firstName }} {{ address.lastName }}</span>
                    <br>{{ address.lineOne }}
                    {% if address.lineTwo is not null %}
                        {% if address.lineTwo != '' %}<br>{{ address.lineTwo }}{% endif %} 
                    {% endif %}
                    <br>{{ address.postcode }} {{ address.city }}
                    <br>{{ attribute(address.country, purchase.lang) }}
                </p>
            {% else %}
                <h3>{{ 'relay.or.locker' | trans({}, 'messages', purchase.lang) }}</h3>
                <p>
                    {{ purchase.shippingInfo.relay.name }}
                    <br>{{ purchase.shippingInfo.relay.lineOne }}
                    {% if purchase.shippingInfo.relay.lineTwo is not null %}<br>{{ purchase.shippingInfo.relay.lineTwo }}{% endif %} 
                    <br>{{ purchase.shippingInfo.relay.postcode }} {{  purchase.shippingInfo.relay.city }}
                    <br>{{ attribute(purchase.deliveryDetail.country, purchase.lang) }}
                </p>
            {% endif %}
                
            
        </div>
        <div>
            <h3>{{ 'invoiceAddress' | trans({}, 'messages', purchase.lang) }}</h3>
            {% set address = purchase.invoiceDetail %}
            <p>
                <span style="text-transform: capitalize;">{{ address.civility | trans({}, 'configs', purchase.lang) }} {{ address.firstName }} {{ address.lastName }}</span>
                <br>{{ address.lineOne }}
                {% if address.lineTwo is not null %}
                    {% if address.lineTwo != '' %}<br>{{ address.lineTwo }}{% endif %} 
                {% endif %}
                <br>{{ address.postcode }} {{ address.city }}
                <br>{{ attribute(address.country, purchase.lang) }}
            </p>
        </div>
        <div>
            <h3>{{ 'orderSummary.date' | trans({}, 'messages', purchase.lang) }}</h3>
            <div>{{ purchase.createdAt.format('d/m/Y H:h') }}</div>
        </div>
        <div>
            <h3>{{ 'status' | trans({}, 'messages', purchase.lang) }}</h3>
            <div>{{ purchase.status | trans({}, 'configs') }}</div>
        </div>
    </div>

    <p style="margin: 40px 0 20px;">{{ 'orderSummary.link.title' | trans({}, 'messages', purchase.lang) }} :</p>

    <p>
        <a style="color: #009095; text-transform: uppercase; font-weight: 600; font-size: .9em;" href="{{ url('account_purchase', {_locale: purchase.lang}) }}" target="_blank">
            {{ 'orderSummary.link' | trans({}, 'messages', purchase.lang) }}
        </a>
    </p>
{% endblock %}















